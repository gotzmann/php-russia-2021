<?phpdeclare(strict_types=1);use Swoole\Http\Request;use Swoole\Http\Response;use Illuminate\Database\Capsule\Manager as ORM;require_once __DIR__ . '/vendor/autoload.php';$dotenv = Dotenv\Dotenv::createImmutable(__DIR__);$dotenv->load();// --- Set up router and one route$routes = [    'GET' => [],    'POST' => [ '/products/list' => 'App\Handlers\Handler::listProducts' ]];$router = function (Request $request, Response $response) use ($routes) {    $method = $request->getMethod();    $path = $request->server['request_uri'];    if (isset($routes[$method][$path])) {        call_user_func($routes[$method][$path], $request, $response);    } else {        $response->status(404);    }};// --- Set up Swoole HTTP server and Eloquent ORM for each worker$server = new Swoole\HTTP\Server(    getenv('LISTEN_HOST'),    intval(getenv('LISTEN_PORT')),);$server->set([    'worker_num' => intval(shell_exec('nproc')) * 4]);$server->on("WorkerStart", function($server, $workerId){    $orm = new ORM;    $orm->addConnection([        'driver'   => getenv('DB_TYPE'),        'host'     => getenv('DB_HOST'),        'port'     => getenv('DB_PORT'),        'database' => getenv('DB_NAME'),        'username' => getenv('DB_USER'),        'password' => getenv('DB_PASSWORD'),        'options'  => [ \PDO::ATTR_TIMEOUT => 5 ],    ]);    $orm->setAsGlobal();});$server->on('Request', $router);// --- Let's go!$server->start();